<!DOCTYPE html>
<html>
    <head>
        <title>Scriptwriters Utility</title>
        <script type="text/javascript" src="print.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="main.css" />
    </head>
    <body>
        
        <div id="divContainer">
            <h2 id="title">Scriptwriter's Utility</h2>
            <div id="divContInner">
                <div class="inner" id="divInput">
                    <textarea id="inputString"></textarea>
                </div>
                <div class="inner" id="divOutput">
                    <div class="statSection"><h3>Line Count: </h3><p id="lineCounter" class="highlightStat">0</p></div><br>
                    <div class="statSection"><h3>Spoken Word Count: </h3><p id="wordCounter" class="highlightStat">0</p></div><br>
                    <div class="statSection"><h3>Number of Characters: </h3><p id="charCounter" class="highlightStat">0</p></div><br>
                    <div class="statSection"><h3>Estimated Length: </h3><p id="estLengthMin" class="highlightStat">0</p><p> to </p><p id="estLengthMax" class="highlightStat">0</p><p>minutes</p></div><br>
                    <div class="statSection"><h3>Character and Wordcount List: </h3><div class="statSection"></div></div>
                </div>
            </div>
        </div>
        
        
        
        
        <script>            
            //do this every time you input something
            $("#inputString").keyup(function(){
                var charWordStorage = [];
                var dialogueWords;
                var dialogueWordsLength;
                
                //grabbing textInput each time keyup
                var textInput = $(this).val();
                //println(textInput);
                
                //word counting
                var wordArray = textInput.split("\n");
                var noWords = wordArray.length;
                $("#lineCounter").text(noWords);
                
                //this will grab ascii and check if its a tab, space, or colon
                //println(textInput[1].charCodeAt(0));
                
                //cycle thru each line and do..
                for(iterationLine = 0; iterationLine < noWords; iterationLine++){
                    
                    //split line by colon, first half name, second half dialogue
                    if(wordArray[iterationLine].indexOf(":") != -1){
                        //found a colon in line, then split colon into 2 parts
                        var dialogueStorage = wordArray[iterationLine].split(":");
                        //println(dialogueStorage[0]);
                        
                        //search object for current name
                        var nameIndex = charWordStorage.map(function(e) { return e.name; }).indexOf(dialogueStorage[0]);
                        //println(nameIndex);
                        if(nameIndex == -1){
                            //if does not exist
                            
                            //split string, so it counts words not characters
                            dialogueWords = dialogueStorage[1].split(" ");
                            dialogueWordsLength = dialogueWords.length - 1;
                            
                            //make object
                            var tempObject = {
                                name: dialogueStorage[0],
                                wordcount: dialogueWordsLength
                            }
                            charWordStorage.push(tempObject);
                            
                        }
                        else{
                            //if it does exist
                            
                            //split string, so it counts words not characters
                            dialogueWords = dialogueStorage[1].split(" ");
                            dialogueWordsLength = dialogueWords.length - 1;
                            
                            //add it to existing index                            
                            charWordStorage[nameIndex].wordcount += dialogueWordsLength;
                        }
                        //debug section
                        //println(nameIndex);
                        //println(charWordStorage[0].name + " " + charWordStorage[0].wordcount);
                    }
                    else{
                        //did not find colon in line
                    }
                    
                    //this will return the content of the evaluated line
                    //println(wordArray[iterationLine]);
                }; //end of line cycle
                
                //count no characters
                $("#charCounter").text(charWordStorage.length);
                
                //count total no spoken words
                var spokenWordCounter = 0;
                for(spokenWorditeration = 0; spokenWorditeration < charWordStorage.length; spokenWorditeration++){
                    spokenWordCounter += charWordStorage[spokenWorditeration].wordcount;
                    $("#wordCounter").text(spokenWordCounter);
                }
                
                //length estimator
                var lengthLow = spokenWordCounter / 240;
                var lengthHigh = spokenWordCounter / 150;
                $("#estLengthMin").text(lengthLow.toPrecision(2));
                $("#estLengthMax").text(lengthHigh.toPrecision(2));
                
            }); //end of input refresh
            
            
            
        </script>
        
    </body>
</html>